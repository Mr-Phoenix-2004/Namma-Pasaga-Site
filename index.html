<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Namma Pasaga Shopping</title>
  <!-- Google Fonts: Product Sans alternative (use 'Roboto' for closest look) -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <!-- Add this inside your <header> nav, after the Cart button -->
<button id="logout-btn" style="background:#ea4335; color:#fff; border:none; border-radius:6px; padding:0.5em 1.2em; font-weight:600; cursor:pointer; margin-left:1em;">Logout</button>
  <style>
    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: #f8fafc;
      color: #222;
      margin: 0;
      padding: 0;
    }
    #dancing-title-container {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      margin: 2.5em 0 1.2em 0;
      user-select: none;
      pointer-events: none;
      perspective: 600px;
    }
    .dancing-title-character {
      display: inline-block;
      font-family: 'Roboto', Arial, sans-serif;
      font-weight: 500;
      font-size: 3.2rem;
      background: none;
      color: #4285f4;
      text-shadow: 0 2px 0 #fff, 0 4px 12px #4285f455;
      animation: dance-wave 1.3s infinite cubic-bezier(.68,-0.55,.27,1.55);
      margin: 0 0.04em;
      letter-spacing: 0.01em;
      transition: color 0.2s;
    }
    /* Google logo colors for each letter */
    .dancing-title-character:nth-child(1) { color: #4285f4; }
    .dancing-title-character:nth-child(2) { color: #ea4335; }
    .dancing-title-character:nth-child(3) { color: #fbbc05; }
    .dancing-title-character:nth-child(4) { color: #4285f4; }
    .dancing-title-character:nth-child(5) { color: #34a853; }
    .dancing-title-character:nth-child(6) { color: #ea4335; }
    .dancing-title-character:nth-child(7) { color: #fbbc05; }
    .dancing-title-character:nth-child(8) { color: #4285f4; }
    .dancing-title-character:nth-child(9) { color: #34a853; }
    .dancing-title-character:nth-child(10) { color: #ea4335; }
    .dancing-title-character:nth-child(11) { color: #fbbc05; }
    .dancing-title-character:nth-child(12) { color: #4285f4; }
    .dancing-title-character:nth-child(13) { color: #34a853; }
    .dancing-title-character:nth-child(14) { color: #ea4335; }
    .dancing-title-character:nth-child(15) { color: #fbbc05; }
    .dancing-title-character:nth-child(16) { color: #4285f4; }
    .dancing-title-character:nth-child(17) { color: #34a853; }
    .dancing-title-character:nth-child(18) { color: #ea4335; }
    .dancing-title-character:nth-child(19) { color: #fbbc05; }
    .dancing-title-character:nth-child(20) { color: #4285f4; }
    @keyframes dance-wave {
      0%,100% { transform: translateY(0);}
      20% { transform: translateY(-22px) scale(1.13);}
      40% { transform: translateY(0);}
    }
    .navbar {
      background: #fff;
      box-shadow: 0 1px 4px #e0e7ef33;
      padding: 18px 0 10px 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .search-container {
      display: flex;
      width: 100%;
      max-width: 600px;
      background: #f1f3f4;
      border-radius: 8px;
      box-shadow: 0 2px 4px #e0e7ef22;
      padding: 2px 8px;
      border: 1.5px solid #d1d5db;
    }
    #searchInput {
      flex: 1;
      padding: 12px 18px;
      border: none;
      border-radius: 24px 0 0 24px;
      font-size: 1.1rem;
      background: transparent;
      outline: none;
      font-family: 'Roboto', Arial, sans-serif;
    }
    #searchButton {
      padding: 0 22px;
      background: #4285f4;
      border: none;
      border-radius: 0 24px 24px 0;
      font-size: 1.1rem;
      color: #fff;
      cursor: pointer;
      font-family: 'Roboto', Arial, sans-serif;
      font-weight: 500;
      transition: background 0.2s;
    }
    #searchButton:hover {
      background: #1967d2;
    }
    .site-title {
      font-family: 'Pacifico', cursive;
      font-size: 2.2rem;
      color: #2874f0;
      text-align: center;
      margin: 1em 0 0.5em 0;
    }
    header { display: flex; justify-content: flex-end; align-items: center; padding: 1em 2em; background: #fff; box-shadow: 0 2px 8px #e0e7ef33; }
    /* nav styles can be added here if needed */
    #cart-btn { background: #2874f0; color: #fff; border: none; border-radius: 6px; padding: 0.5em 1.2em; font-weight: 600; cursor: pointer; }
    main { max-width: 900px; margin: 0 auto; }
    .products {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.2em;
      padding: 2em 0;
    }
    .product-card {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 4px 16px #e0e7ef55;
      min-height: 420px;
      max-width: 370px;
      margin: 0 auto;
      border: 1px solid #e3e6ef;
      transition: box-shadow 0.2s, transform 0.15s;
      cursor: pointer;
      display: flex;
      flex-direction: column;
    }
    .product-card:hover {
      box-shadow: 0 8px 32px #b3c6e755;
      transform: translateY(-4px) scale(1.03);
      border-color: #2874f0;
    }
    .product-image {
      width: 100%;
      height: 260px;
      object-fit: contain;
      background: #f6f7fa;
      border-bottom: 1px solid #e3e6ef;
      padding: 1.2em 0;
      max-width: 100%;
    }
    .product-info { padding: 1.3em 1.1em 1.1em 1.1em; flex: 1; display: flex; flex-direction: column; }
    .product-name { font-size: 1.18em; font-weight: 700; color: #212121; margin-bottom: 0.4em; letter-spacing: 0.01em; }
    .product-desc { font-size: 1em; color: #555; margin-bottom: 1em; flex: 1; }
    .product-bottom { display: flex; align-items: center; justify-content: space-between; margin-top: 0.7em; }
    .product-price { color: #388e3c; font-weight: 700; font-size: 1.15em; }
    .product-actions { display: flex; gap: 0.7em; }
    .add-to-cart, .order-now-btn {
      border: none;
      border-radius: 5px;
      padding: 0.5em 1.3em;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 8px #e0e7ef22;
      transition: background 0.15s;
    }
    .add-to-cart { background: #2874f0; color: #fff; }
    .add-to-cart:hover { background: #1855b6; }
    .order-now-btn { background: #fb641b; color: #fff; text-decoration: none; }
    .order-now-btn:hover { background: #d35400; }
    .pagination-bar {
      display: flex; justify-content: center; align-items: center; gap: 1em; margin: 1em 0;
    }
    .pagination-btn {
      background: #2874f0; color: #fff; border: none; border-radius: 5px; padding: 0.4em 1em; font-weight: 600; cursor: pointer;
    }
    .pagination-btn:disabled { background: #b0c4e7; cursor: not-allowed; }
    #searchResults {
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
      display: none;
    }
    .product {
      background-color: #fff;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 4px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 1em;
    }
    .product img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      border-radius: 4px;
      background: #f6f7fa;
    }
    .product-info {
      flex: 1;
    }
    .product-name {
      font-weight: bold;
      color: #2874f0;
    }
    .product-desc {
      color: #555;
      font-size: 0.97em;
    }
    .product-price {
      color: #388e3c;
      font-weight: 600;
      margin-top: 0.3em;
    }
    .product-actions {
      display: flex;
      gap: 0.5em;
      margin-top: 0.5em;
    }
    @media (max-width: 900px) {
      .products { grid-template-columns: 1fr 1fr; }
      .product-image { height: 160px; }
    }
    @media (max-width: 600px) {
      .products { grid-template-columns: 1fr; gap: 1em; padding: 1em 0.2em; }
      .product-card { min-height: 340px; }
      .product-image { height: 100px; }
      header { flex-direction: column; gap: 0.5em; padding: 1em; }
      #cart-items .cart-product-img { width: 64px !important; height: 64px !important; margin-right: 0.7em; }
    }
    /* Cart modal styles */
    #cart-modal {
      display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: #0008; z-index: 1000; align-items: center; justify-content: center;
    }
    #cart-modal .modal-content {
      background: #fff; border-radius: 16px; max-width: 520px; width: 96%; padding: 2.2em 2em 1.7em 2em;
      box-shadow: 0 8px 32px #0003; position: relative;
    }
    #cart-items .cart-product-img {
      width: 90px !important; height: 90px !important; object-fit: cover;
      border-radius: 10px; margin-right: 1.2em; background: #f6f7fa;
      border: 1px solid #e3e6ef; box-shadow: 0 2px 8px #e0e7ef33;
    }
    #cart-items .cart-product-info, #cart-items div[style*="font-size:0.95em"] {
      font-size: 1.18em !important; font-weight: 600;
    }
  </style>
</head>
<body>
  <script>
    if (localStorage.getItem('np_logged_in') !== '1') {
      window.location.href = 'login.html';
    }
  </script>
  <button class="wishlist-btn" onclick="addToWishlist(productId)">❤️ Wishlist</button>

<script>
  function addToWishlist(productId) {
    fetch('/add-to-wishlist', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ product_id: productId })
    })
    .then(response => response.json())
    .then(data => alert(data.message));
  }
</script>
  <!-- ...existing code... -->
  <div id="dancing-title-container"></div>
  <div class="navbar">
    <div class="search-container">
      <input type="text" id="searchInput" placeholder="Search for products, brands and more" />
      <button id="searchButton">Search</button>
    </div>
  </div>
  <div id="searchResults"></div>
  <header>
    <nav>
      <button id="cart-btn">Cart (<span id="cart-count">0</span>)</button>
    </nav>
  </header>
  <!-- Cart Modal -->
  <div id="cart-modal">
    <div class="modal-content">
      <button id="close-cart-modal" style="position:absolute; top:1em; right:1.2em; background:none; border:none; font-size:1.6em; cursor:pointer; color:#888;">&times;</button>
      <h2 style="margin-top:0; font-size:1.5em; color:#2874f0; letter-spacing:0.01em; text-align:center;">🛒 Your Cart</h2>
      <div id="cart-items" style="margin-bottom:1.2em; color:#444; font-size:1.12em; max-height:380px; overflow-y:auto; border-bottom:1px solid #e3e6ef; padding-bottom:1em;"></div>
      <div id="cart-total" style="font-weight:600; color:#388e3c; margin-bottom:1.2em; font-size:1.12em; background:#f8fafc; border-radius:7px; padding:0.9em 1.2em;"></div>
      <button id="checkout-btn" style="background:#fb641b; color:#fff; border:none; border-radius:7px; padding:1em 1.4em; font-weight:600; cursor:pointer; width:100%; font-size:1.12em; margin-bottom:0.7em;">Checkout</button>
      <button id="cart-order-btn" style="background:#2874f0; color:#fff; border:none; border-radius:7px; padding:1em 1.4em; font-weight:600; cursor:pointer; width:100%; font-size:1.12em;">Order</button>
    </div>
  </div>
  <!-- Order Modal -->
  <div id="order-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0008; z-index:1000; align-items:center; justify-content:center;">
    <div style="background:#fff; border-radius:10px; max-width:350px; width:90%; padding:1.5em; box-shadow:0 4px 24px #0002; position:relative;">
      <button id="close-order-modal" style="position:absolute; top:0.7em; right:1em; background:none; border:none; font-size:1.3em; cursor:pointer;">&times;</button>
      <h2 style="margin-top:0; font-size:1.2em; color:#2874f0;">Order Details</h2>
      <form id="order-form">
        <div style="margin-bottom:0.7em;">
          <label for="order-name" style="display:block; margin-bottom:0.2em;">Name</label>
          <input type="text" id="order-name" name="name" required style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-address" style="display:block; margin-bottom:0.2em;">Address</label>
          <textarea id="order-address" name="address" required rows="2" style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;"></textarea>
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-phone" style="display:block; margin-bottom:0.2em;">Phone</label>
          <input type="tel" id="order-phone" name="phone" required pattern="[0-9]{10}" style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-email" style="display:block; margin-bottom:0.2em;">Email</label>
          <input type="email" id="order-email" name="email" required style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-landmark" style="display:block; margin-bottom:0.2em;">Landmark</label>
          <input type="text" id="order-landmark" name="landmark" required style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-city" style="display:block; margin-bottom:0.2em;">City</label>
          <input type="text" id="order-city" name="city" required style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-pincode" style="display:block; margin-bottom:0.2em;">Pincode</label>
          <input type="text" id="order-pincode" name="pincode" required pattern="\d{6}" maxlength="6" style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div id="order-product-info" style="margin-bottom:0.7em; color:#555; font-size:0.98em;"></div>
        <button type="submit" style="background:#fb641b; color:#fff; border:none; border-radius:5px; padding:0.6em 1.2em; font-weight:600; cursor:pointer; width:100%;">Place Order</button>
      </form>
      <div id="order-success" style="display:none; color:#388e3c; font-weight:600; margin-top:1em; text-align:center;">Order placed successfully!</div>
    </div>
  </div>
  <script>
    // Global pagination variables (declare only once)
    const PRODUCTS_PER_PAGE = 6;
    let currentPage = 1;
    let TOTAL_PAGES = 1;

    // Dancing title
    document.addEventListener("DOMContentLoaded", function() {
      const txt = "Namma Pasaga Shopping";
      let c = document.getElementById("dancing-title-container");
      c.innerHTML = [...txt].map((ch,i)=>
        `<span class="dancing-title-character" style="animation-delay:${i*0.09}s">${ch===" "?"&nbsp;":ch}</span>`
      ).join("");
    });

    // Product data
    window.products = [
      { id: 1, name: "Tshirt", desc: "Comfortable cotton t-shirt.", price: 200, img: "https://cdn.pixabay.com/photo/2024/04/29/04/21/tshirt-8726716_1280.jpg" },
      { id: 2, name: "Shirt", desc: "Classic formal shirt.", price: 350, img: "https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=600&q=80" },
      { id: 3, name: "Jean Pant", desc: "Trendy jean pant.", price: 500, img: "https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=600&q=80" },
      { id: 4, name: "Bluetooth Speaker", desc: "Portable, waterproof, high-quality sound.", price: 1999, img: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=600&q=80" },
      { id: 5, name: "Eco Water Bottle", desc: "Stainless steel, leak-proof.", price: 599, img: "https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=600&q=80" },
      { id: 6, name: "Handmade Jute Bag", desc: "Eco-friendly, stylish.", price: 899, img: "https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=600&q=80" },
      { id: 7, name: "Wireless Earbuds", desc: "Long battery, touch controls.", price: 2499, img: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=600&q=80" },
      { id: 8, name: "Yoga Mat", desc: "Non-slip, extra thick.", price: 1099, img: "https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=600&q=80" },
      { id: 9, name: "Classic Sunglasses", desc: "UV protection, stylish.", price: 699, img: "https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=600&q=80" },
      { id: 10, name: "Desk Organizer", desc: "Wooden, neat workspace.", price: 499, img: "https://images.unsplash.com/photo-1513708927688-890a1e2b6b8a?auto=format&fit=crop&w=600&q=80" },
      { id: 11, name: "Travel Backpack", desc: "Spacious, water-resistant.", price: 1799, img: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80" },
      { id: 12, name: "Smart Watch", desc: "Track fitness, notifications.", price: 2999, img: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=600&q=80" }
    ];
    // Set TOTAL_PAGES after products are loaded
    TOTAL_PAGES = Math.ceil(window.products.length / PRODUCTS_PER_PAGE);

    // Cart logic
    let cart = [];

    function updateCartCount() {
      document.getElementById('cart-count').textContent = cart.reduce((sum, item) => sum + item.qty, 0);
    }

    function calculateCartTotals() {
      const GST_RATE = 0.18, DELIVERY_CHARGES = 50, HANDLING_FEES = 20;
      const subtotal = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
      const gst = Math.round(subtotal * GST_RATE);
      const delivery = cart.length > 0 ? DELIVERY_CHARGES : 0;
      const handling = cart.length > 0 ? HANDLING_FEES : 0;
      const total = subtotal + gst + delivery + handling;
      return { subtotal, gst, delivery, handling, total };
    }

    function showCartModal() {
      const cartItemsDiv = document.getElementById('cart-items');
      if (cart.length === 0) {
        cartItemsDiv.innerHTML = '<div style="text-align:center;">Your cart is empty.</div>';
        document.getElementById('cart-total').innerHTML = '';
        document.getElementById('checkout-btn').disabled = true;
        document.getElementById('cart-order-btn').disabled = true;
      } else {
        cartItemsDiv.innerHTML = cart.map(item => `
          <div style="display:flex; align-items:center; margin-bottom:0.7em;">
            <img src="${item.img}" alt="${item.name}" class="cart-product-img">
            <div class="cart-product-info" style="flex:1;">
              <div>${item.name}</div>
              <div style="font-size:0.95em; color:#388e3c;">₹${item.price} x ${item.qty}</div>
            </div>
            <button class="cart-remove" data-id="${item.id}" style="background:none; border:none; color:#fb641b; font-size:1.2em; cursor:pointer;">&times;</button>
          </div>
        `).join('');
        const { subtotal, gst, delivery, handling, total } = calculateCartTotals();
        document.getElementById('cart-total').innerHTML = `
          <div>Subtotal: ₹${subtotal}</div>
          <div>GST (18%): ₹${gst}</div>
          <div>Delivery Charges: ₹${delivery}</div>
          <div>Handling Fees: ₹${handling}</div>
          <div style="font-weight:700; color:#2874f0; margin-top:0.5em;">Total: ₹${total}</div>
        `;
        document.getElementById('cart-modal').style.display = 'flex';
      }
    }

    // Product grid rendering and pagination
    function renderProducts(page) {
      const section = document.querySelector('.products');
      section.innerHTML = '';
      const start = (page - 1) * PRODUCTS_PER_PAGE;
      const end = start + PRODUCTS_PER_PAGE;
      products.slice(start, end).forEach(product => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
          <img src="${product.img}" alt="${product.name}" class="product-image" />
          <div class="product-info">
            <div class="product-name">${product.name}</div>
            <div class="product-desc">${product.desc}</div>
            <div class="product-bottom">
              <span class="product-price">₹${product.price}</span>
              <div class="product-actions">
                <button class="add-to-cart">Add to Cart</button>
                <a href="#" class="order-now-btn">Order Now</a>
                <button class="like-btn" title="Add to Wishlist">❤️ Like</button>
              </div>
            </div>
          </div>
        `;
        // Add click event to open product page (except when clicking buttons)
        card.addEventListener('click', function(e) {
          if (
            e.target.classList.contains('add-to-cart') ||
            e.target.classList.contains('order-now-btn')
          ) return;
          window.location.href = `product-${product.id}.html`;
        });
        section.appendChild(card);
      });
      attachProductCardEvents();
    }

    function updatePaginationBar() {
      document.getElementById('page-indicator').textContent = `Page ${currentPage} of ${TOTAL_PAGES}`;
      document.getElementById('prev-page').disabled = currentPage === 1;
      document.getElementById('next-page').disabled = currentPage === TOTAL_PAGES;
    }

    document.getElementById('prev-page').onclick = function() {
      if (currentPage > 1) { currentPage--; renderProducts(currentPage); updatePaginationBar(); }
    };
    document.getElementById('next-page').onclick = function() {
      if (currentPage < TOTAL_PAGES) { currentPage++; renderProducts(currentPage); updatePaginationBar(); }
    };

    // Attach events to product cards
    function attachProductCardEvents() {
      document.querySelectorAll('.product-card').forEach((card, idx) => {
        card.onclick = function(e) {
          if (
            e.target.classList.contains('add-to-cart') ||
            e.target.classList.contains('order-now-btn')
          ) return;
          const start = (currentPage - 1) * PRODUCTS_PER_PAGE;
          const product = products[start + idx];
          showProductModal(product);
        };
        card.querySelector('.add-to-cart').onclick = function(ev) {
          ev.stopPropagation();
          const start = (currentPage - 1) * PRODUCTS_PER_PAGE;
          const product = products[start + idx];
          const existing = cart.find(item => item.id === product.id);
          if (existing) existing.qty += 1;
          else cart.push({ id: product.id, name: product.name, price: product.price, img: product.img, qty: 1 });
          updateCartCount();
        };
        card.querySelector('.order-now-btn').onclick = function(ev) {
          ev.preventDefault();
          ev.stopPropagation();
          const start = (currentPage - 1) * PRODUCTS_PER_PAGE;
          const product = products[start + idx];
          document.getElementById('order-product-info').textContent = `Product: ${product.name} | Price: ₹${product.price}`;
          document.getElementById('order-modal').style.display = 'flex';
          document.getElementById('order-form').reset();
          document.getElementById('order-success').style.display = 'none';
        };
        card.querySelector('.like-btn').onclick = function(ev) {
          ev.stopPropagation();
          const username = localStorage.getItem('np_user');
          if (!username) {
            alert('Please log in to use wishlist.');
            return;
          }
          let wishlist = getWishlist(username);
          if (!Array.isArray(wishlist)) wishlist = [];
          if (!wishlist.includes(product.id)) {
            wishlist.push(product.id);
            saveWishlist(username, wishlist);
            // Optionally, update button style to show liked
            this.classList.add('liked');
            this.textContent = '❤️ Liked';
          } else {
            // Optionally, allow unliking
            wishlist = wishlist.filter(id => id !== product.id);
            saveWishlist(username, wishlist);
            this.classList.remove('liked');
            this.textContent = '❤️ Like';
          }
        };
      });
    }

    // Product modal
    function showProductModal(product) {
      let modal = document.getElementById('product-modal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'product-modal';
        modal.style = 'display:flex; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0008; z-index:1001; align-items:center; justify-content:center;';
        modal.innerHTML = `
          <div style="background:#fff; border-radius:12px; max-width:370px; width:92%; padding:1.5em; box-shadow:0 4px 24px #0002; position:relative;">
            <button id="close-product-modal" style="position:absolute; top:0.7em; right:1em; background:none; border:none; font-size:1.3em; cursor:pointer;">&times;</button>
            <img src="" alt="" id="modal-product-img" style="width:100%; height:170px; object-fit:cover; border-radius:8px; margin-bottom:1em;">
            <div style="font-size:1.2em; font-weight:700; color:#2874f0;" id="modal-product-name"></div>
            <div style="color:#555; margin:0.5em 0 1em 0;" id="modal-product-desc"></div>
            <div style="font-size:1.1em; color:#388e3c; font-weight:600; margin-bottom:1em;" id="modal-product-price"></div>
            <div style="display:flex; gap:0.7em;">
              <button class="add-to-cart" style="background:#2874f0; color:#fff; border:none; border-radius:4px; padding:0.5em 1.2em; font-weight:600; cursor:pointer;">Add to Cart</button>
              <a href="#" class="order-now-btn" style="background:#fb641b; color:#fff; border:none; border-radius:4px; padding:0.5em 1.2em; font-weight:600; text-decoration:none; cursor:pointer;">Order Now</a>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }
      document.getElementById('modal-product-img').src = product.img;
      document.getElementById('modal-product-img').alt = product.name;
      document.getElementById('modal-product-name').textContent = product.name;
      document.getElementById('modal-product-desc').textContent = product.desc;
      document.getElementById('modal-product-price').textContent = `₹${product.price}`;
      modal.style.display = 'flex';
      modal.querySelector('.add-to-cart').onclick = function() {
        const existing = cart.find(item => item.id === product.id);
        if (existing) existing.qty += 1;
        else cart.push({ id: product.id, name: product.name, price: product.price, img: product.img, qty: 1 });
        updateCartCount();
        modal.style.display = 'none';
      };
      modal.querySelector('.order-now-btn').onclick = function(e) {
        e.preventDefault();
        document.getElementById('order-product-info').textContent = `Product: ${product.name} | Price: ₹${product.price}`;
        document.getElementById('order-modal').style.display = 'flex';
        document.getElementById('order-form').reset();
        document.getElementById('order-success').style.display = 'none';
        modal.style.display = 'none';
      };
      document.getElementById('close-product-modal').onclick = function() {
        modal.style.display = 'none';
      };
      modal.onclick = function(e) {
        if (e.target === modal) modal.style.display = 'none';
      };
    }

    // Search logic
    function renderSearchResults(results) {
      const resultsDiv = document.getElementById("searchResults");
      if (results.length === 0) {
        resultsDiv.innerHTML = "<p>No products found.</p>";
      } else {
        resultsDiv.innerHTML = "";
        results.forEach(product => {
          const div = document.createElement("div");
          div.className = "product";
          div.innerHTML = `
            <img src="${product.img}" alt="${product.name}">
            <div class="product-info">
              <div class="product-name">${product.name}</div>
              <div class="product-desc">${product.desc}</div>
              <div class="product-price">₹${product.price}</div>
              <div class="product-actions">
                <button class="add-to-cart" data-id="${product.id}">Add to Cart</button>
                <a href="#" class="order-now-btn" data-id="${product.id}">Order Now</a>
              </div>
            </div>
          `;
          resultsDiv.appendChild(div);
        });
      }
      resultsDiv.style.display = "block";
      const mainProducts = document.querySelector('.products');
      if (mainProducts) mainProducts.style.display = "none";
      const pagination = document.getElementById('product-pagination');
      if (pagination) pagination.style.display = "none";
    }

    function clearSearchResults() {
      const resultsDiv = document.getElementById("searchResults");
      resultsDiv.innerHTML = "";
      resultsDiv.style.display = "none";
      const mainProducts = document.querySelector('.products');
      if (mainProducts) mainProducts.style.display = "";
      const pagination = document.getElementById('product-pagination');
      if (pagination) pagination.style.display = "";
    }

    function searchProduct() {
      const query = document.getElementById("searchInput").value.trim().toLowerCase();
      if (!query) {
        clearSearchResults();
        return;
      }
      const results = products.filter(product =>
        product.name.toLowerCase().includes(query) ||
        product.desc.toLowerCase().includes(query)
      );
      renderSearchResults(results);
    }

    // Event listeners
    document.addEventListener("DOMContentLoaded", function() {
      renderProducts(currentPage);
      updatePaginationBar();

      document.getElementById("searchButton").addEventListener("click", searchProduct);
      document.getElementById("searchInput").addEventListener("keydown", function(e) {
        if (e.key === "Enter") searchProduct();
        if (!this.value.trim()) clearSearchResults();
      });
      document.getElementById("searchInput").addEventListener("input", function() {
        if (!this.value.trim()) clearSearchResults();
      });

      // Cart modal open/close
      document.getElementById('cart-btn').onclick = showCartModal;
      document.getElementById('close-cart-modal').onclick = function() {
        document.getElementById('cart-modal').style.display = 'none';
      };

      // Cart remove
      document.getElementById('cart-items').onclick = function(e) {
        if (e.target.classList.contains('cart-remove')) {
          const id = parseInt(e.target.dataset.id);
          cart = cart.filter(item => item.id !== id);
          showCartModal();
          updateCartCount();
        }
      };

      // Cart checkout
      document.getElementById('checkout-btn').onclick = function() {
        alert('Checkout functionality coming soon!');
        document.getElementById('cart-modal').style.display = 'none';
      };

      // Cart order
      document.getElementById('cart-order-btn').onclick = function() {
        if (cart.length === 0) {
          alert('Your cart is empty.');
          return;
        }
        let errorMsg = "";
        const name = document.getElementById('order-name').value.trim();
        const address = document.getElementById('order-address').value.trim();
        const phone = document.getElementById('order-phone').value.trim();
        const landmark = document.getElementById('order-landmark').value.trim();
        const city = document.getElementById('order-city').value.trim();
        const pincode = document.getElementById('order-pincode').value.trim();
        if (!name) errorMsg += "Please enter your name.\n";
        if (!address) errorMsg += "Please enter your address.\n";
        if (!phone) errorMsg += "Please enter your phone number.\n";
        if (!landmark) errorMsg += "Please enter a landmark.\n";
        if (!city) errorMsg += "Please enter your city.\n";
        if (!pincode.match(/^\d{6}$/)) errorMsg += "Please enter a valid 6-digit pincode.\n";
        if (errorMsg) {
          alert(errorMsg);
          return false;
        }
        document.getElementById('order-success').style.display = 'block';
        setTimeout(() => {
          document.getElementById('order-modal').style.display = 'none';
        }, 1500);
        return false;
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const closeOrderBtn = document.getElementById('close-order-modal');
      if (closeOrderBtn) {
        closeOrderBtn.onclick = function() {
          document.getElementById('order-modal').style.display = 'none';
        };
      }
    });
  </script>
  <!-- Order Details Modal -->
  <div id="order-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0008; z-index:1000; align-items:center; justify-content:center;">
    <div style="background:#fff; border-radius:10px; max-width:350px; width:90%; padding:1.5em; box-shadow:0 4px 24px #0002; position:relative;">
      <button id="close-order-modal" style="position:absolute; top:0.7em; right:1em; background:none; border:none; font-size:1.3em; cursor:pointer;">&times;</button>
      <h2 style="margin-top:0; font-size:1.2em; color:#2874f0;">Order Details</h2>
      <form id="order-form">
        <div style="margin-bottom:0.7em;">
          <label for="order-name" style="display:block; margin-bottom:0.2em;">Name</label>
          <input type="text" id="order-name" name="name" required style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-address" style="display:block; margin-bottom:0.2em;">Address</label>
          <textarea id="order-address" name="address" required rows="2" style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;"></textarea>
        </div>
        <div style="margin-bottom:0.7em;">
          <label for="order-phone" style="display:block; margin-bottom:0.2em;">Phone</label>
          <input type="tel" id="order-phone" name="phone" required pattern="[0-9]{10}" style="width:100%; padding:0.5em; border-radius:5px; border:1px solid #ccc;">
        </div>
        <div id="order-product-info" style="margin-bottom:0.7em; color:#555; font-size:0.98em;"></div>
        <button type="submit" style="background:#fb641b; color:#fff; border:none; border-radius:5px; padding:0.6em 1.2em; font-weight:600; cursor:pointer; width:100%;">Place Order</button>
      </form>
      <div id="order-success" style="display:none; color:#388e3c; font-weight:600; margin-top:1em; text-align:center;">Order placed successfully!</div>
    </div>
  </div>
  <script>
    // Removed sort/filter logic
    // Open order modal when "Order Now" is clicked
    document.addEventListener('click', function(e) {
      if (e.target.classList.contains('order-now-btn')) {
        e.preventDefault();
        const card = e.target.closest('.product-card');
        const name = card.querySelector('.product-name').textContent;
        const price = card.querySelector('.product-price').textContent;
        document.getElementById('order-product-info').textContent = `Product: ${name} | Price: ${price}`;
        document.getElementById('order-modal').style.display = 'flex';
        document.getElementById('order-form').reset();
        document.getElementById('order-success').style.display = 'none';
      }
      if (e.target.id === 'close-order-modal') {
        document.getElementById('order-modal').style.display = 'none';
      }
    });
    document.getElementById('order-form').onsubmit = function(ev) {
      ev.preventDefault();
      document.getElementById('order-success').style.display = 'block';
      setTimeout(() => {
        document.getElementById('order-modal').style.display = 'none';
      }, 1500);
    };
  </script>
  <main>
    <div id="product-pagination" class="pagination-bar">
      <button id="prev-page" class="pagination-btn" disabled>&laquo; Prev</button>
      <span id="page-indicator">Page 1</span>
      <button id="next-page" class="pagination-btn">Next &raquo;</button>
    </div>
    <section class="products"></section>
  </main>
  <script>
    function showProductModal(product) {
      let modal = document.getElementById('product-modal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'product-modal';
        modal.style = 'display:flex; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0008; z-index:1001; align-items:center; justify-content:center;';
        modal.innerHTML = `
          <div style="background:#fff; border-radius:12px; max-width:370px; width:92%; padding:1.5em; box-shadow:0 4px 24px #0002; position:relative;">
            <button id="close-product-modal" style="position:absolute; top:0.7em; right:1em; background:none; border:none; font-size:1.3em; cursor:pointer;">&times;</button>
            <img src="" alt="" id="modal-product-img" style="width:100%; height:170px; object-fit:cover; border-radius:8px; margin-bottom:1em;">
            <div style="font-size:1.2em; font-weight:700; color:#2874f0;" id="modal-product-name"></div>
            <div style="color:#555; margin:0.5em 0 1em 0;" id="modal-product-desc"></div>
            <div style="font-size:1.1em; color:#388e3c; font-weight:600; margin-bottom:1em;" id="modal-product-price"></div>
            <div style="display:flex; gap:0.7em;">
              <button class="add-to-cart" style="background:#2874f0; color:#fff; border:none; border-radius:4px; padding:0.5em 1.2em; font-weight:600; cursor:pointer;">Add to Cart</button>
              <a href="#" class="order-now-btn" style="background:#fb641b; color:#fff; border:none; border-radius:4px; padding:0.5em 1.2em; font-weight:600; text-decoration:none; cursor:pointer;">Order Now</a>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }
      document.getElementById('modal-product-img').src = product.img;
      document.getElementById('modal-product-img').alt = product.name;
      document.getElementById('modal-product-name').textContent = product.name;
      document.getElementById('modal-product-desc').textContent = product.desc;
      document.getElementById('modal-product-price').textContent = `₹${product.price}`;
      modal.style.display = 'flex';
      modal.querySelector('.add-to-cart').onclick = function() {
        const existing = cart.find(item => item.id === product.id);
        if (existing) existing.qty += 1;
        else cart.push({ id: product.id, name: product.name, price: product.price, img: product.img, qty: 1 });
        updateCartCount();
        modal.style.display = 'none';
      };
      modal.querySelector('.order-now-btn').onclick = function(e) {
        e.preventDefault();
        document.getElementById('order-product-info').textContent = `Product: ${product.name} | Price: ₹${product.price}`;
        document.getElementById('order-modal').style.display = 'flex';
        document.getElementById('order-form').reset();
        document.getElementById('order-success').style.display = 'none';
        modal.style.display = 'none';
      };
      document.getElementById('close-product-modal').onclick = function() {
        modal.style.display = 'none';
      };
      modal.onclick = function(e) {
        if (e.target === modal) modal.style.display = 'none';
      };
    }
    function attachProductCardEvents() {
      document.querySelectorAll('.product-card').forEach((card, idx) => {
        card.onclick = function(e) {
          if (
            e.target.classList.contains('add-to-cart') ||
            e.target.classList.contains('order-now-btn')
          ) return;
          const start = (currentPage - 1) * PRODUCTS_PER_PAGE;
          const product = products[start + idx];
          showProductModal(product);
        };
      });
    }
    const style = document.createElement('style');
    style.textContent = `
      .products {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
      gap: 2em !important;
      padding: 2.5em 0 !important;
      }
      .product-card {
      border-radius: 14px !important;
      box-shadow: 0 4px 16px #e0e7ef55 !important;
      min-height: 420px !important;
      max-width: 370px;
      margin: 0 auto;
      border: 1px solid #e3e6ef;
      transition: box-shadow 0.2s, transform 0.15s;
      cursor: pointer;
      background: #fff;
      display: flex;
      flex-direction: column;
      }
      .product-card:hover {
      box-shadow: 0 8px 32px #b3c6e755;
      transform: translateY(-4px) scale(1.03);
      border-color: #2874f0;
      }
      .product-image {
      width: 100%;
      height: 220px !important;
      object-fit: contain !important;
      background: #f6f7fa;
      border-bottom: 1px solid #e3e6ef;
      padding: 1.2em 0;
      }
      .product-info {
      padding: 1.3em 1.1em 1.1em 1.1em !important;
      flex: 1;
      display: flex;
      flex-direction: column;
      }
      .product-name {
      font-size: 1.18em !important;
      font-weight: 700 !important;
      color: #212121 !important;
      margin-bottom: 0.4em !important;
      letter-spacing: 0.01em;
      }
      .product-desc {
      font-size: 1em !important;
      color: #555 !important;
      margin-bottom: 1em !important;
      flex: 1;
      }
      .product-bottom {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 0.7em;
      }
      .product-price {
      color: #388e3c !important;
      font-weight: 700 !important;
      font-size: 1.15em !important;
      }
      .product-actions {
      display: flex;
      gap: 0.7em !important;
      }
      .add-to-cart, .order-now-btn {
      border: none;
      border-radius: 5px !important;
      padding: 0.5em 1.3em !important;
      font-size: 1em !important;
      font-weight: 600 !important;
      cursor: pointer;
      box-shadow: 0 2px 8px #e0e7ef22;
      transition: background 0.15s;
      }
      .add-to-cart {
      background: #2874f0 !important;
      color: #fff !important;
      }
      .add-to-cart:hover {
      background: #1855b6 !important;
      }
      .order-now-btn {
      background: #fb641b !important;
      color: #fff !important;
      text-decoration: none !important;
      }
      .order-now-btn:hover {
      background: #d35400 !important;
      }
      @media (max-width: 900px) {
      .products { grid-template-columns: 1fr 1fr !important; }
      .product-image { height: 160px !important; }
      }
      @media (max-width: 600px) {
      .products { grid-template-columns: 1fr !important; }
      .product-card { min-height: 340px !important; }
      .product-image { height: 120px !important; }
      }
    `;
    document.head.appendChild(style);
    function renderProducts(page) {
      const section = document.querySelector('.products');
      section.innerHTML = '';
      const start = (page - 1) * PRODUCTS_PER_PAGE;
      const end = start + PRODUCTS_PER_PAGE;
      products.slice(start, end).forEach(product => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
          <img src="${product.img}" alt="${product.name}" class="product-image" />
          <div class="product-info">
            <div class="product-name">${product.name}</div>
            <div class="product-desc">${product.desc}</div>
            <div class="product-bottom">
              <span class="product-price">₹${product.price}</span>
              <div class="product-actions">
                <button class="add-to-cart">Add to Cart</button>
                <a href="order.html?product=${product.id}" class="order-now-btn">Order Now</a>
              </div>
            </div>
          </div>
        `;
        section.appendChild(card);
      });
      attachProductCardEvents();
    }
    function updatePaginationBar() {
      document.getElementById('page-indicator').textContent = `Page ${currentPage} of ${TOTAL_PAGES}`;
      document.getElementById('prev-page').disabled = currentPage === 1;
      document.getElementById('next-page').disabled = currentPage === TOTAL_PAGES;
    }
    document.getElementById('prev-page').onclick = function() {
      if (currentPage > 1) { currentPage--; renderProducts(currentPage); updatePaginationBar(); }
    };
    document.getElementById('next-page').onclick = function() {
      if (currentPage < TOTAL_PAGES) { currentPage++; renderProducts(currentPage); updatePaginationBar(); }
    };
    renderProducts(currentPage);
    updatePaginationBar();
    function sendOrderSMS(name, address, phone, orderInfo) {
      const smsApiUrl = "https://api.callmebot.com/signal/send.php";
      const params = new URLSearchParams({
        phone: "+919176381612",
        text: `New Order!\nName: ${name}\nAddress: ${address}\nPhone: ${phone}\n${orderInfo}`,
        apikey: "free"
      });
      fetch(`${smsApiUrl}?${params.toString()}`)
        .then(() => {})
        .catch(() => {});
    }
    document.getElementById('order-form').addEventListener('submit', function(ev) {
      ev.preventDefault();
      const name = document.getElementById('order-name').value.trim();
      const address = document.getElementById('order-address').value.trim();
      const phone = document.getElementById('order-phone').value.trim();
      const orderInfo = document.getElementById('order-product-info').textContent;
      sendOrderSMS(name, address, phone, orderInfo);
      document.getElementById('order-success').style.display = 'block';
      setTimeout(() => {
        document.getElementById('order-modal').style.display = 'none';
      }, 1500);
    });
  </script>
  <!-- Add this script at the end of your <body> (or inside your main script block) -->
<script>
  const logoutBtn = document.getElementById('logout-btn');
  if (logoutBtn) {
    logoutBtn.onclick = function() {
      localStorage.removeItem('np_logged_in');
      localStorage.removeItem('np_user');
      window.location.href = 'login.html';
    };
  }
  // Save wishlist for a user
function saveWishlist(username, wishlist) {
    localStorage.setItem('wishlist_' + username, JSON.stringify(wishlist));
}
// Get wishlist for a user
function getWishlist(username) {
    return JSON.parse(localStorage.getItem('wishlist_' + username) || '[]');
}

</script>
</body>
</html>